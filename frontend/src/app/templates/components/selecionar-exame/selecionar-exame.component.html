<div class="mat-dialog">
  <h2 class="m-0" mat-dialog-title>Selecionar Exame</h2>

  <div mat-dialog-content class="py-3">
    <div class="row">
      <div class="col-12">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Exame</mat-label>
          <input
            matInput
            placeholder="Nome ou categoria"
            [(ngModel)]="filterString"
            (keyup.enter)="search()"
          />
          <button matSuffix mat-icon-button (click)="search()">
            <mat-icon>search</mat-icon>
          </button>
        </mat-form-field>
      </div>
    </div>

    <div
      [hidden]="(dataSource && dataSource.data.length == 0) || isLoadingResults"
    >
      <div class="row">
        <div class="col-12">
          <div class="table-responsive">
            <table
              mat-table
              [dataSource]="dataSource"
              class="w-100 border"
              matSort
              matSortActive="nome"
              matSortDisableClear
              matSortDirection="asc"
              (matSortChange)="sortChange()"
            >
              <!-- Index Column -->
              <ng-container matColumnDef="index">
                <th
                  mat-header-cell
                  *matHeaderCellDef
                  mat-sort-header
                  class="col-index"
                >
                  #
                </th>
                <td mat-cell *matCellDef="let categoria; let i = index">
                  {{ i + 1 }}
                </td>
              </ng-container>

              <!-- Nome Column -->
              <ng-container matColumnDef="nome">
                <th
                  mat-header-cell
                  *matHeaderCellDef
                  mat-sort-header
                  class="col-nome"
                >
                  Nome
                </th>
                <td mat-cell *matCellDef="let categoria" class="text-center">
                  {{ categoria.nome }}
                </td>
              </ng-container>

              <!-- Categoria Column -->
              <ng-container matColumnDef="categoria">
                <th
                  mat-header-cell
                  *matHeaderCellDef
                  mat-sort-header
                  class="col-categoria"
                >
                  Categoria
                </th>
                <td mat-cell *matCellDef="let categoria" class="text-center">
                  {{ categoria.categoria }}
                </td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="columns"></tr>
              <tr
                mat-row
                *matRowDef="let row; columns: columns"
                [ngClass]="exame && exame.id === row.id ? 'selected-row' : ''"
                (click)="select(row)"
              ></tr>
            </table>

            <mat-paginator
              [length]="resultsLength"
              [pageSizeOptions]="[10, 25, 50, 100]"
              showFirstLastButtons
              class="w-100"
              (page)="pageChange()"
            ></mat-paginator>
          </div>
        </div>
      </div>
    </div>

    <div [hidden]="!isLoadingResults">
      <div class="row">
        <div class="col-12">
          <mat-progress-bar mode="indeterminate"></mat-progress-bar>
          <p class="text-center pt-3">Obtendo dados</p>
        </div>
      </div>
    </div>

    <div
      [hidden]="(dataSource && dataSource.data.length > 0) || isLoadingResults"
    >
      <div class="row">
        <div class="col-12">
          <div class="text-center">
            <img src="/assets/images/nao-encontrado.png" width="100px" />
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-12">
          <div class="text-center">
            <h2 class="m-0">Não há dados a serem exibidos!</h2>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div mat-dialog-actions layout="row" class="d-flex justify-content-end">
    <button mat-button mat-dialog-close>Cancelar</button>
    <button
      mat-button
      [ngClass]="exame ? 'bg-success text-white' : ''"
      (click)="submit()"
      [disabled]="!exame"
    >
      OK
    </button>
  </div>
</div>
